package com.example.fluxo_de_cliente;

import com.example.fluxo_de_cliente.model.Usuario;
import com.example.fluxo_de_cliente.model.Cliente;
import com.example.fluxo_de_cliente.service.AuthService;
import com.example.fluxo_de_cliente.service.ClienteService;

import java.util.List;
import java.util.Scanner;

public class Launcher {

    public static void main(String[] args) {

        Scanner scanner = new Scanner(System.in);
        AuthService authService = new AuthService();
        ClienteService clienteService = new ClienteService();

        System.out.println("=== LOGIN ===");
        System.out.print("Email: ");
        String email = scanner.nextLine();

        System.out.print("Senha: ");
        String senha = scanner.nextLine();

        Usuario usuario = authService.login(email, senha);

        if (usuario == null) {
            System.out.println("âŒ Email ou senha invÃ¡lidos");
            return;
        }

        System.out.println("âœ… Login realizado com sucesso");
        System.out.println("UsuÃ¡rio: " + usuario.getNome());
        System.out.println("Cargo: " + usuario.getCargo());

        boolean running = true;

        while (running) {
            if (usuario.getCargo().equalsIgnoreCase("ADMIN")) {
                System.out.println("\nâ¡ï¸ Menu do ADMIN");
                System.out.println("1 - Criar vendedor");
                System.out.println("2 - Listar clientes");
                System.out.println("3 - Apagar cliente");
                System.out.println("0 - Sair");
                System.out.print("Escolha uma opÃ§Ã£o: ");
                int opcao = scanner.nextInt();
                scanner.nextLine(); // limpar buffer

                switch (opcao) {
                    case 1 -> {
                        System.out.print("Nome do vendedor: ");
                        String nome = scanner.nextLine();
                        System.out.print("Email do vendedor: ");
                        String emailV = scanner.nextLine();
                        System.out.print("Senha do vendedor: ");
                        String senhaV = scanner.nextLine();
                        authService.criarVendedor(nome, emailV, senhaV);
                        System.out.println("âœ… Vendedor criado com sucesso!");
                    }
                    case 2 -> {
                        List<Cliente> clientes = clienteService.listarClientes();
                        if (clientes.isEmpty()) {
                            System.out.println("Nenhum cliente registrado.");
                        } else {
                            System.out.println("Clientes cadastrados:");
                            for (Cliente c : clientes) {
                                System.out.println(c.getId() + " | " + c.getNome() +
                                        " | Valor: " + c.getValor() +
                                        " | Criado por: " + c.getCriadoPor());
                            }
                        }
                    }
                    case 3 -> {
                        System.out.print("ID do cliente para apagar: ");
                        int id = scanner.nextInt();
                        scanner.nextLine();
                        clienteService.apagarCliente(id);
                        System.out.println("âœ… Cliente apagado!");
                    }
                    case 0 -> running = false;
                    default -> System.out.println("OpÃ§Ã£o invÃ¡lida!");
                }
            } else { // VENDEDOR
                System.out.println("\nâ¡ï¸ Menu do VENDEDOR");
                System.out.println("1 - Criar cliente");
                System.out.println("2 - Listar meus clientes");
                System.out.println("0 - Sair");
                System.out.print("Escolha uma opÃ§Ã£o: ");
                int opcao = scanner.nextInt();
                scanner.nextLine(); // limpar buffer

                switch (opcao) {
                    case 1 -> {
                        System.out.print("Nome do cliente: ");
                        String nomeCliente = scanner.nextLine();
                        System.out.print("Valor do cliente: ");
                        double valorCliente = scanner.nextDouble();
                        scanner.nextLine();
                        clienteService.criarCliente(nomeCliente, valorCliente, usuario.getEmail());
                        System.out.println("âœ… Cliente criado com sucesso!");
                    }
                    case 2 -> {
                        List<Cliente> clientes = clienteService.listarClientes();
                        boolean encontrou = false;
                        for (Cliente c : clientes) {
                            if (c.getCriadoPor().equalsIgnoreCase(usuario.getEmail())) {
                                System.out.println(c.getId() + " | " + c.getNome() + " | Valor: " + c.getValor());
                                encontrou = true;
                            }
                        }
                        if (!encontrou) System.out.println("VocÃª ainda nÃ£o criou clientes.");
                    }
                    case 0 -> running = false;
                    default -> System.out.println("OpÃ§Ã£o invÃ¡lida!");
                }
            }
        }

        System.out.println("ğŸ”’ Sistema finalizado. AtÃ© mais!");
    }
}troque o laucher para abrir na classe PaginaInicial que estra dentro da pasta view